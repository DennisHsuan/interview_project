{% extends 'base.html' %}
{% load static %}
{% block title %}
<title>菜單-新品上市</title>
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
<!-- Bootstrap js -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8"
    crossorigin="anonymous"></script>
<style>
    img {
        width: 100%;
        height: 800px;
        padding-top: 40px;
        
    }
    .row{
        padding: 20px;
    }
    .image {
        /* margin-top: 10px; */
        width: 100%;
        height: 250px;
        display: block;
        opacity: 0;
        transition: opacity 3s;
    }

    .loaded {
        opacity: 1;
    }

    h4 {
        padding-top: 20px;
    }
</style>
{% endblock %}
{% block content %}
<!-- 設定輪播時的(slide)滑動跟(fade)淡入-->
<div id="carousel_1" class="carousel slide carousel-fade" data-bs-ride="carousel">
    <!-- carousel Indicators(輪播指標) 設定指標區塊-->
    <div class="carousel-indicators">
        <button type="button" data-bs-target="#carousel_1" data-bs-slide-to="0" class="active"></button>
        <button type="button" data-bs-target="#carousel_1" data-bs-slide-to="1"></button>
        <button type="button" data-bs-target="#carousel_1" data-bs-slide-to="2"></button>
        <button type="button" data-bs-target="#carousel_1" data-bs-slide-to="3"></button>
    </div>
    <!-- 輪播時的照片 -->
    <div class="carousel-inner">
        <div class="carousel-item active">
            <img src="{% static 'images/new_products/oko.png' %}" class="d-block w-100" loading="lazy" alt="...">
        </div>
        <div class="carousel-item">
            <img src="{% static 'images/new_products/cold.png' %}" class="d-block w-100" alt="...">
        </div>
        <div class="carousel-item">
            <img src="{% static 'images/new_products/litchi.png' %}" class="d-block w-100" alt="...">
        </div>
        <div class="carousel-item">
            <img src="{% static 'images/new_products/lemon.png' %}" class="d-block w-100" alt="...">
        </div>
    </div>
    <!-- 上下頁箭頭設定 -->
    <button class="carousel-control-prev" type="button" data-bs-target="#carousel_1" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">上一頁</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carousel_1" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">下一頁</span>
    </button>
</div>
<!-- 設定一個Layout網格(grid)-->
<div class="container text-center">
    <h4>菜單介紹</h4>
    <div class="row">
        {% for product in products %}
        <div class="col">
            <!-- 在包一個元件卡片(card) my-3(margin Y象限-距離3)-->
            <div class="card my-3 mx-auto" style="width: 18rem;">
                <!-- Lazyload(延遲加載) -->
                <img class="image lazyload" data-src="/static/images/products/{{product.pimage}}" class="card-img-top" alt="...">
                <div class="card-body">
                    <!-- fw-bold 字體加粗 -->
                    <h5 class="card-title fw-bold">{{ product.pname }}</h5>
                    <p class="card-text">{{ product.pprice}}元</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
<!--測試-->
<div class="container text-center my-3">
    <h3>Bootstrap 4 Multiple Item Carousel</h3>
    <div id="recipeCarousel" class="carousel slide w-100" data-ride="carousel">
        <div class="carousel-inner w-100" role="listbox">
            <div class="carousel-item row no-gutters active">
                <div class="col-3 float-left"><img class="img-fluid" src="{% static 'images/movies/245_1.jpg' %}"></div>
                <div class="col-3 float-left"><img class="img-fluid" src="{% static 'images/movies/245_2.jpg' %}"></div>
                <div class="col-3 float-left"><img class="img-fluid" src="{% static 'images/movies/245_3.jpg' %}"></div>
                <div class="col-3 float-left"><img class="img-fluid" src="{% static 'images/movies/245_4.jpg' %}"></div>
            </div>
            <div class="carousel-item row no-gutters">
                <div class="col-3 float-left"><img class="img-fluid" src="{% static 'images/movies/245_5.jpg' %}"></div>
                <div class="col-3 float-left"><img class="img-fluid" src="{% static 'images/movies/245_6.jpg' %}"></div>
                <div class="col-3 float-left"><img class="img-fluid" src="{% static 'images/movies/245_7.jpg' %}"></div>
                <div class="col-3 float-left"><img class="img-fluid" src="{% static 'images/movies/245_8.jpg' %}"></div>
            </div>
        </div>
        <a class="carousel-control-prev" href="#recipeCarousel" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#recipeCarousel" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
    <h4>Advances all 4 slides each time</h4>
</div>
<!-- 第二個輪播 -->
<div id="carousel_2" class="carousel slide carousel-fade" data-bs-ride="carousel">
    <!-- carousel Indicators(輪播指標) 設定指標區塊-->
    <div class="carousel-indicators">
        <button type="button" data-bs-target="#carousel_2" data-bs-slide-to="0" class="active"></button>
        <button type="button" data-bs-target="#carousel_2" data-bs-slide-to="1"></button>
        <button type="button" data-bs-target="#carousel_2" data-bs-slide-to="2"></button>
    </div>
    <!-- 輪播時的照片 -->
    <div class="carousel-inner">
        <div class="carousel-item active">
            <img src="{% static 'images/movies/245_1.jpg' %}" class="d-block w-100" loading="lazy" alt="...">
        </div>
        <div class="carousel-item">
            <img src="{% static 'images/movies/245_1.jpg' %}" class="d-block w-100" alt="...">
        </div>
        <div class="carousel-item">
            <img src="{% static 'images/movies/245_1.jpg' %}" class="d-block w-100" alt="...">
        </div>
        <div class="carousel-item">
            <img src="{% static 'images/movies/245_1.jpg' %}" class="d-block w-100" alt="...">
        </div>
    </div>
    <!-- 上下頁箭頭設定 -->
    <button class="carousel-control-prev" type="button" data-bs-target="#carousel_2" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">上一頁</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carousel_2" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">下一頁</span>
    </button>
</div>
<!-- addEventListener 增加監聽 -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const lazyloadImages = document.querySelectorAll(".lazyload");  //選擇全部的文件檔案(".lazyload")
        const observer = new IntersectionObserver(function (entries, observer) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src;
                    img.classList.add("loaded");
                    observer.unobserve(img);
                }
            });
        });

        lazyloadImages.forEach(img => {
            observer.observe(img);
        });
    });
</script>
{% endblock %}